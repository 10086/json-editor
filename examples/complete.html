<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title>Complete JSON Editor Example</title>

    <!-- Foundation CSS framework (Bootstrap and jQueryUI also supported) -->
    <link rel='stylesheet' href='//cdn.jsdelivr.net/bootstrap/3.2.0/css/bootstrap.css'>
    <!-- Font Awesome icons (Bootstrap, Foundation, and jQueryUI also supported) -->
    <link rel='stylesheet' href='//cdnjs.cloudflare.com/ajax/libs/font-awesome/4.0.3/css/font-awesome.css'>

    <link rel='stylesheet' href='//cdn.jsdelivr.net/sceditor/1.4.3/jquery.sceditor.default.min.css'>
    <link rel='stylesheet' href='//cdn.jsdelivr.net/sceditor/1.4.3/themes/modern.min.css'>
    <script src='//cdn.jsdelivr.net/jquery/2.1.1/jquery.min.js'></script>
    <script src='//cdn.jsdelivr.net/sceditor/1.4.3/jquery.sceditor.min.js'></script>
    <script src='//cdn.jsdelivr.net/sceditor/1.4.3/plugins/xhtml.js'></script>

    <script src="../dist/jsoneditor.js"></script>
</head>
<body>
<div class='container'>
    <div class='row' style='padding-bottom: 15px;'>
        <div class='col-md-12'>
            <h1>Complete JSON Editor Example</h1>

            <p>This example attempts to demonstrate as many features of JSON Editor as possible in a single JSON Schema.</p>
        </div>
    </div>
    <div class='row' style='padding-bottom: 15px;'>
        <div class='col-md-12'>
            <button id='submit' class='btn btn-info'>Submit (console.log)</button>
            <button id='restore' class='btn btn-info'>Restore to Default</button>
            <button id='enable_disable' class='btn btn-info'>Disable/Enable Form</button>
            <span id='valid_indicator' class='label label-success'></span>
        </div>
    </div>
    <div class='row'>
        <div class='col-md-12'>
            <div id='editor_holder'></div>
        </div>
    </div>


</div>

<script>
    JSONEditor.defaults.theme = 'bootstrap3';
    JSONEditor.defaults.iconlib = 'fontawesome4';
    JSONEditor.plugins.sceditor.style = "//cdn.jsdelivr.net/sceditor/1.4.3/jquery.sceditor.default.min.css";

    var starting_value = undefined;

    // Initialize the editor
    var editor = new JSONEditor(document.getElementById('editor_holder'),{
        // The schema for the editor
        schema: {
            title: "Person",
            headerTemplate: "Person - {{self.fname}} {{self.lname}}",
            $ref: "#/definitions/person",
            definitions: {
                person: {
                    type: "object",
                    id: "person",
                    defaultProperties: [
                        "fname",
                        "lname",
                        "birthYear",
                        "gender",
                        "jobs"
                    ],
                    patternProperties: {
                      "^cousin": {
                        $ref: "#/definitions/person"
                      }
                    },
                    properties: {
                        fname: {
                            title: "first name",
                            type: "string",
                            minLength: 1
                        },
                        lname: {
                            title: "last name",
                            type: "string",
                            minLength: 1
                        },
                        birthYear: {
                            title: "birth year",
                            $ref: "#/definitions/year",
                            maximum: 1996
                        },
                        gender: {
                            type: "string",
                            enum: ["male","female"],
                            default: "female"
                        },
                        favoriteJob: {
                            type: "string",
                            title: "favorite job",
                            enumSource: [
                                [""],
                                {
                                    source: "jobs",
                                    value: "{{item.position}} at {{item.company}}"
                                }
                            ],
                            watch: {
                                jobs: "person.jobs"
                            }
                        },
                        jobs: {
                            type: "array",
                            format: "tabs",
                            items: {
                                type: "object",
                                title: "job",
                                headerTemplate: "{{self.position}} at {{self.company}}",
                                required: [
                                    "position",
                                    "company",
                                    "yearStart",
                                    "yearEnd",
                                    "description"
                                ],
                                additionalProperties: false,
                                properties: {
                                    position: {
                                        type: "string"
                                    },
                                    company: {
                                        type: "string"
                                    },
                                    yearStart: {
                                        title: "start year",
                                        $ref: "#/definitions/year",
                                        default: 2000
                                    },
                                    yearEnd: {
                                        title: "end year",
                                        oneOf: [
                                            {
                                                title: "present",
                                                type: "null"
                                            },
                                            {
                                                title: "year",
                                                $ref: "#/definitions/year"
                                            }
                                        ]
                                    },
                                    description: {
                                        type: "string",
                                        format: "html",
                                        options: {
                                            wysiwyg: true
                                        }
                                    }
                                }
                            }
                        },
                        coworkers: {
                          type: "array",
                          items: {
                            title: "Coworker",
                            $ref: "#/definitions/person"
                          }
                        },
                        bestFriend: {
                          title: "best friend",
                          oneOf: [
                            {
                              title: "none",
                              type: "null"
                            },
                            {
                              title: "person",
                              $ref: "#/definitions/person"
                            }
                          ]
                        }
                    }
                },
                year: {
                    type: "integer",
                    pattern: "^[0-9]{4}$",
                    minimum: 1900,
                    maximum: 2100
                }
            }
        },

        // Seed the form with a starting value
        startval: starting_value
    });

    // Hook up the submit button to log to the console
    document.getElementById('submit').addEventListener('click',function() {
        // Get the value from the editor
        console.log(editor.getValue());
    });

    // Hook up the Restore to Default button
    document.getElementById('restore').addEventListener('click',function() {
        editor.setValue(starting_value);
    });

    // Hook up the enable/disable button
    document.getElementById('enable_disable').addEventListener('click',function() {
        // Enable form
        if(!editor.isEnabled()) {
            editor.enable();
        }
        // Disable form
        else {
            editor.disable();
        }
    });

    // Hook up the validation indicator to update its
    // status whenever the editor changes
    editor.on('change',function() {
        // Get an array of errors from the validator
        var errors = editor.validate();

        var indicator = document.getElementById('valid_indicator');

        // Not valid
        if(errors.length) {
            indicator.className = 'label label-danger'
            indicator.textContent = "not valid";
        }
        // Valid
        else {
            indicator.className = 'label label-success'
            indicator.textContent = "valid";
        }
    });
</script>
</body>
</html>
